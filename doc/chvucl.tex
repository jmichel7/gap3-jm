%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%A  chvucl.tex       CHEVIE documentation       Frank Luebeck, Jean Michel
%%
%Y  Copyright (C) 2010  Lehrstuhl D f\"ur Mathematik, RWTH Aachen,
%Y  and   University Paris VII.
%%
%%  This  file  contains  the  description  of  the  GAP functions of CHEVIE
%%  dealing with unipotent classes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\gg{{\mathfrak g}}
\def\Sym{{\mathfrak S}}
\def\gsl{{\mathfrak sl}}
\def\cB{{\mathcal B}}
\def\bG{{\bf G}}
\def\bS{{\bf S}}
\def\bT{{\bf T}}

\Chapter{Unipotent classes of reductive groups}
\CHEVIE\  contains information about  the unipotent conjugacy  classes of a
connected  reductive  group  over  an  algebraically  closed field $k$, and
various  invariants attached to  them. The unipotent  classes depend on the
characteristic of $k$; their classification differs when the characteristic
is  not *good*  (that is,  when it  divides one  of the coefficients of the
highest  root).  In  good  characteristic,  the  unipotent  classes  are in
bijection with nilpotent orbits on the Lie algebra.

\CHEVIE\  contains the following information attached to the class $C$ of a
unipotent element $u$\:
\begin{itemize}
\item  its centralizer $C_\bG(u)$, characterized by its reductive part, its
group  of components $A(u):=C_\bG(u)/C_\bG(u)^0$, and  the dimension of its
radical.
\item in good characteristic, its  Dynkin-Richardson  diagram.
\item  the Springer correspondence, attaching  characters of the Weyl group
or relative Weyl groups to each character of $A(u)$.
\end{itemize}

The  Dynkin-Richarson diagram is attached to a nilpotent element $e$ of the
Lie algebra $\gg$. By the Jacobson-Morozov theorem there exists an $\gsl_2$
subalgebra of $\gg$ containing $e$ as the element
$\left(\begin{array}{cc}0&1\\0&0\end{array}\right)$. Let $\bS$ be the torus
$\left(\begin{array}{cc}h&0\\0&h^{-1}\end{array}\right)$  of SL$_2$ and let
$\bT$  be a maximal torus containing $\bS$ so  that $\bS$ is the image of a
one-parameter  subgroup $\sigma\in Y(\bT)$. Consider the root decomposition
$\gg=\sum_{\alpha\in\Sigma}\gg_\alpha$ given by $\bT$; then
$\alpha\mapsto\langle\sigma,\alpha\rangle$   defines   a   linear  form  on
$\Sigma$, determined by its value on simple roots. It is possible to choose
a  system of simple roots  $\Pi$ so that $\langle\sigma,\alpha\rangle\ge 0$
for  $\alpha\in\Pi$, and then $\langle\sigma,\alpha\rangle\in\{0,1,2\}$ for
any  $\alpha\in\Pi$. The Dynkin diagram of  $\Pi$ decorated by these values
$0,1,2$  is  called  the  Dynkin-Richardson  diagram  of  $e$,  and in good
characteristic is a complete invariant of its $\gg$-orbit.

Let  $\cB$ be  the variety  of all  Borel subgroups  and let $\cB_u$ be the
subvariety  of Borel subgroups  containing the unipotent  element $u$. Then
$\dim   C_\bG(u)=rank\bG+2\dim\cB_u$  and   in  good   characteristic  this
dimension   can  be  computed  from  the  Dynkin-Richardson  diagram\:  the
dimension  of the class  of $u$ is  the number of  roots $\alpha$ such that
$\langle\sigma,\alpha\rangle\notin\{0,1\}$.

We   describe  now  the  Springer  correspondence.  Indecomposable  locally
constant  $\bG$-equivariant  sheaves  on  $C$,  called *local systems*, are
parameterized  by irreducible characters of $A(u)$. The *ordinary* Springer
correspondence  is a bijection  between irreducible characters  of the Weyl
group  and a large subset  of the local systems  which contains all trivial
local  systems (those parameterized by the  trivial character of $A(u)$ for
each  $u$).  More  generally,  the  *generalized*  Springer  correspondence
associates  to each local system a (unique up to $\bG$-conjugacy) *cuspidal
pair*  of a Levi subgroup $\bL$ of $\bG$ and a local system on an unipotent
class  of $\bL$, such that  the set of local  systems associated to a given
cuspidal pair is parameterized by the characters of the relative Weyl group
$W_\bG(\bL):=N_\bG(\bL)/\bL$. There are only few cuspidal pairs.

The  Springer correspondence gives information on the character values of a
finite  reductive  groups  as  follows\:  assume  that $k$ is the algebraic
closure  of a finite field $\F_q$ and that $F$ is the Frobenius attached to
an  $\F_q$-structure of $\bG$. Let $C$ be an $F$-stable unipotent class and
let  $u\in  C^F$;  we  call  $C$  the  *geometric  class*  of  $u$  and the
$\bG^F$-classes inside $C^F$ are parameterized by the $F$-conjugacy classes
of  $A(u)$, denoted $H^1(F,A(u))$  (most of the  time we can  find $u$ such
that  $F$  acts  trivially  on  $A(u)$  and  $H^1(F,A(u))$ is then just the
conjugacy  classes).  To  an  $F$-stable  character  $\varphi$ of $A(u)$ we
associate  the *characteristic function* of  the corresponding local system
(actually   associated  to  an  extension   $\tilde\varphi$  of  $\phi$  to
$A(u).F$);  it is a class function  $Y_{u,\varphi}$ on $\bG^F$ which can be
normalized  so  that\:  $Y_{u,\varphi}(u_1)=\tilde\varphi(cF)$  if $u_1$ is
geometrically  conjugate to $u$  and its $\bG^F$-class  is parameterized by
the  $F$-conjugacy class $cF$  of $A(u)$, otherwise $Y_{u,\varphi}(u_1)=0$.
If  the pair $u,\varphi$ corresponds via the Springer correspondence to the
character  $\chi$  of  $W_\bG(\bL)$,  then  $Y_{u,\varphi}$ is also denoted
$Y_\chi$.  There is another  important class of  functions indexed by local
systems\:  to  a  local  system  on  class  $C$ is attached an intersection
cohomology  complex, which is a complex of sheaves supported on the closure
$\overline   C$.  To   such  a   complex  of   sheaves  is  associated  its
*characteristic  function*, a class function  of $\bG^F$ obtained by taking
the  alternating  trace  of  the  Frobenius  acting  on  the  stalks of the
cohomology  sheaves. If $Y_\psi$ is the  characteristic function of a local
system,  the  characteristic  function  of  the  corresponding intersection
cohomology  complex is denoted  by $X_\psi$. This  function is supported on
$\overline  C$, and Lusztig has  shown that $X_\psi=\sum_\phi P_{\psi,\chi}
Y_\chi$  where $P_{\psi,\chi}$ are integer  polynomials in $q$ and $Y_\chi$
are attached to local systems on classes lying in $\overline C$.

Lusztig   and  Shoji  have  given  an   algorithm  to  compute  the  matrix
$P_{\psi,\chi}$,  which is  implemented in  \CHEVIE. The  relationship with
characters  of  $\bG(\F_q)$,  taking  to  simplify  the  ordinary  Springer
correspondence,  is that the  restriction to the  unipotent elements of the
almost  character $R_\chi$ is equal  to $q^{b_\chi} X_\chi$, where $b_\chi$
is  $\dim \cB_u$ for an element $u$ of  the class $C$ such that the support
of  $\chi$  is  $\overline  C$.  The  restriction  of  the  Deligne-Lusztig
characters $R_w$ to the unipotents are called the *Green functions* and can
also  be computed  by \CHEVIE.  The values  of all  unipotent characters on
unipotent elements can also be computed in principle by applying Lusztig\'s
Fourier  transform matrix (see the section on the Fourier matrix) but there
is a difficulty in that the $X_\chi$ must be first multiplied by some roots
of unity which are not known in all cases (and when known may depend on the
congruence class of $q$ modulo some small primes).

We illustrate these computations on some examples\:

|    gap> W:=CoxeterGroup("A",3,"sc");
    CoxeterGroup("A",3,"sc")
    gap> uc:=UnipotentClasses(W);
    UnipotentClasses( A3 )
    gap> Display(uc);
    1111<211<22<31<4
       u |'\|'|D-R dBu B-C         C(u) A3() A1(2A1)/-1 .(A3)/I .(A3)/-I
    ________________________________________________________________
    4    |'\|'|222   0 222       q^3.Z4  1:4       -1:2      I:      -I:
    31   |'\|'|202   1 22.    q^4.(q-1)   31
    22   |'\|'|020   2 2.2    q^4.A1.Z2 2:22      11:11
    211  |'\|'|101   3 2.. q^5.A1.(q-1)  211
    1111 |'\|'|000   6 ...           A3 1111|

In  'CoxeterGroup(\"A\",3,\"sc\")'  the  '\"sc\"'  specifies  that  we  are
working with the simply connected group, that is $sl_n$; another syntax for
the  same group  is 'RootDatum(\"sl\",4)'.  The first  column in  the table
gives the name of the unipotent class, which here is a partition describing
the  Jordan form. The  partial order on  unipotent classes given by Zariski
closure is given before the table. The column 'D-R', displayed only in good
characteristic,  gives the  Dynkin-Richardson diagram  for each  class; the
column  'dBu' gives the dimension of  the variety $\cB_u$. The column 'B-C'
gives  the Bala-Carter classification of $u$, that is in the case of sl$_4$
it  displays $u$ as  a regular unipotent  in a Levi  subgroup by giving the
Dynkin-Richardson  diagram  of  a  regular  unipotent (all 2\'s) at entries
corresponding to the Levi and '.' at entries which do not correspond to the
Levi.  The column  'C(u)' describes  the group  $C_\bG(u)$\: a  power $q^d$
describes  that the unipotent radical of $C_\bG(u)$ has dimension $d$ (thus
$q^d$ rational points); then follows a description of the reductive part of
the  neutral component of $C_\bG(u)$, given by  the name of its root datum.
Then  if $C_\bG(u)$  is not  connected, the  description of $A(u)$ is given
using another vocabulary: a cyclic group of order 4 is given as 'Z4', and a
symmetric group on 3 points would be given as 'S3'.

For  instance, the first class '4'  has $C_\bG(u)^0$ unipotent of dimension
$3$  and $A(u)$ equal to 'Z4', the cyclic  group of order 4. The class '22'
has  $C_G(u)$ with  unipotent radical  of dimension  $4$, reductive part of
type  'A1' and  $A(u)$ is  'Z2', that  is the  cyclic group of order 2. The
other  classes have $C_\bG(u)$ connected. For  the class '31' the reductive
part of $C_G(u)$ is a torus of rank 1.

Then  there is one column for each *Springer series*, giving for each class
the  pairs  'a\:b'  where  'a'  is  the  name  of  the  character of $A(u)$
describing  the local system involved and 'b'  is the name of the character
of  the (relative) Weyl group corresponding by the Springer correspondence.
At  the top of the  column is written the  name of the relative Weyl group,
and  in brackets the  name of the  Levi affording a  cuspidal local system;
next,  separated  by  a  |/|  is  a  description  of  the central character
associated  to the  Springer series  (omitted if  this central character is
trivial)\:  all  local  systems  in  a  given  Springer  series  have  same
restriction  to the center of  $\bG$. To find what  the picture becomes for
another algebraic group in the same isogeny class, for instance the adjoint
group,  one  simply  discards  the  Springer series whose central character
becomes  trivial on the  center of $\bG$;  and each group  $A(u)$ has to be
quotiented  by the common  kernel of the  remaining characters. Here is the
table for the adjoint group\:

|    gap> Display(UnipotentClasses(CoxeterGroup("A",3)));
    1111<211<22<31<4
       u |'\|'|D-R dBu B-C         C(u) A3()
    ____________________________________
    4    |'\|'|222   0 222          q^3    4
    31   |'\|'|202   1 22.    q^4.(q-1)   31
    22   |'\|'|020   2 2.2       q^4.A1   22
    211  |'\|'|101   3 2.. q^5.A1.(q-1)  211
    1111 |'\|'|000   6 ...           A3 1111|

Here is another example\:

|    gap> W:=CoxeterGroup("G",2);;
    gap> Display(UnipotentClasses(W));
    1<A1<~A1<G2(a1)<G2
         u |'\|'|D-R dBu B-C   C(u)                    G2() .(G2)
    _________________________________________________________
    G2     |'\|'| 22   0  22    q^2                phi{1,0}
    G2(a1) |'\|'| 20   1  20 q^4.S3 21:phi{1,3}' 3:phi{2,1}  111:
    ~A1    |'\|'| 01   2  .2 q^3.A1                phi{2,2}
    A1     |'\|'| 10   3  2. q^5.A1              phi{1,3}''
    1      |'\|'| 00   6  ..     G2                phi{1,6}|

which illustrates that on class 'G2(a1)' there are two local systems in the
principal  series of  the Springer  correspondence, and  a further cuspidal
local system. Also, from the 'B-C' column, we see that that class is not in
a  proper Levi,  in which  case the  Bala-Carter diagram coincides with the
Dynkin-Richardson diagram.

The  characteristics 2 and  3 are not  good for 'G2'.  To get the unipotent
classes  and the Springer correspondence in bad characteristic, one gives a
second argument to the function 'UnipotentClasses'\:

|    gap> Display(UnipotentClasses(W,3));
    1<A1,(~A1)3<~A1<G2(a1)<G2
         u |'\|'|dBu   C(u)       G2() .(G2) .(G2) .(G2)
    ________________________________________________
    G2     |'\|'|  0 q^2.Z3 1:phi{1,0}         E3: E3^2:
    G2(a1) |'\|'|  1 q^4.Z2 2:phi{2,1}   11:
    ~A1    |'\|'|  2    q^6   phi{2,2}
    A1     |'\|'|  3 q^5.A1 phi{1,3}''
    (~A1)3 |'\|'|  3 q^5.A1  phi{1,3}'
    1      |'\|'|  6     G2   phi{1,6}|

The  function 'ICCTable' gives the  transition matrix between the functions
$X_\chi$  and $Y_\psi$.

|    gap> Display(ICCTable(UnipotentClasses(W)));
    Coefficients of X_phi on Y_psi for G2

                |'\|'|G2 G2(a1)(21) G2(a1) ~A1 A1   1
    _____________________________________________
    Xphi{1,0}   |'\|'| 1          0      1   1  1   1
    Xphi{1,3}'  |'\|'| 0          1      0   1  0 q^2
    Xphi{2,1}   |'\|'| 0          0      1   1  1  P8
    Xphi{2,2}   |'\|'| 0          0      0   1  1  P4
    Xphi{1,3}'' |'\|'| 0          0      0   0  1   1
    Xphi{1,6}   |'\|'| 0          0      0   0  0   1|

Here  the row labels  and the column  labels show the  two ways of indexing
local  systems\:\ the  row labels  give the  character of the relative Weyl
group and the column labels give the class and the name of the local system
as  a character  of $A(u)$\:\  for instance,  'G2(a1)' is the trivial local
system  of the  class 'G2(a1)',  while 'G2(a1)(21)'  is the local system on
that class corresponding to the 2-dimensional character of $A(u)=A_2$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Section{UnipotentClasses}
\index{UnipotentClasses}

'UnipotentClasses(<W>[,<p>])'

<W>  should  be  a  'CoxeterGroup'  record  for a Weyl group or 'RootDatum'
describing a reductive algebraic group $\bG$. The function returns a record
containing   information   about   the   unipotent   classes  of  $\bG$  in
characteristic   <p>  (if   omitted,  <p>   is  assumed   to  be  any  good
characteristic for $\bG$). This contains the following fields\:

'group':\\ a pointer to <W>

'p':\\ the characteristic of the field for which the unipotent classes were
computed. It is '0' for any good characteristic.

'orderClasses':\\  a list describing the Hasse diagram of the partial order
induced   on   unipotent   classes   by   the  closure  relation.  That  is
'.orderclasses[i]'  is the list of 'j' such that ${\overline C}_j\supsetneq
{\overline  C}_i$  and  there  is  no  class  $C_k$  such  that ${\overline
C}_j\supsetneq {\overline C}_k\supsetneq {\overline C}_i$.

'classes':\\  a  list  of  records  holding information for each unipotent
class (see below).

'springerSeries':\\  a list of records, each  of which describes a Springer
series  of $\bG$.

The  records  describing  individual  unipotent  classes have the following
fields\:

'name':\\ the name of the unipotent class.

'parameter':  a parameter  describing the  class (for  example, a partition
describing the Jordan form, for classical groups).

'Au':\\ the group $A(u)$.

'dynkin':\\  present in good characteristic; contains the Dynkin-Richardson
diagram,  given  as  a  list  of  0,1,2  describing  the coefficient on the
corresponding simple root.

'red':\\  the reductive part of $C_\bG(u)$.

'dimBu':\\  the dimension of the variety $\cB_u$.

The  records for classes contain additional fields for certain groups\: for
instance,  the names given  to classes by  Mizuno in $E_6,  E_7, E_8$ or by
Shoji in $F_4$.

The  records  describing  individual  Springer  series  have  the following
fields\:

'levi':\\the  indices of the reflections corresponding to the Levi subgroup
$\bL$ where lives the cuspidal local system $\iota$ from which the Springer
series is induced.

'relgroup':\\  The  relative  Weyl  group $N_\bG(\bL,\iota)/\bL$. The first
series is the principal series for which '.levi=[]' and '.relgroup=W'.

'locsys':\\  a list  of length  'NrConjugacyClasses(.relgroup)', holding in
'i'-th  position a  pair describing  which local  system corresponds to the
'i'-th  character of $N_\bG(\bL,\iota)$.  The first element  of the pair is
the index of the concerned unipotent class 'u', and the second is the index
of the corresponding character of $A(u)$.

'Z':\\  the central character associated  to the Springer series, specified
by its value on the generators of the centre.

|    gap> W:=CoxeterGroup("A",3,"sc");;
    gap> uc:=UnipotentClasses(W);
    UnipotentClasses( A3 )
    gap> uc.classes;
    [ UnipotentClass(1111), UnipotentClass(211), UnipotentClass(22),
      UnipotentClass(31), UnipotentClass(4) ]
    gap> PrintRec(uc.classes[3]);
    rec(
      name      := 22,
      Au        := CoxeterGroup("A",1),
      dimBu     := 2,
      dimunip   := 4,
      dimred    := 3,
      parameter := [ 2, 2 ],
      balacarter:= [ 1, 3 ],
      dynkin    := [ 0, 2, 0 ],
      red       := ReflectionSubgroup(CoxeterGroup("A",1), [ 1 ]),
      AuAction  := A1,
      operations:= UnipotentClassOps )
    gap> uc.orderClasses;
    [ [ 2 ], [ 3 ], [ 4 ], [ 5 ], [  ] ]
    gap> uc.springerSeries;
    [ rec(
          relgroup := A3,
          Z := [ 1 ],
          levi := [  ],
          locsys := [ [ 1, 1 ], [ 2, 1 ], [ 3, 2 ], [ 4, 1 ], [ 5, 1 ] ] )
        , rec(
          relgroup := A1,
          Z := [ -1 ],
          levi := [ 1, 3 ],
          locsys := [ [ 3, 1 ], [ 5, 3 ] ] ), rec(
          relgroup := .,
          Z := [ E(4) ],
          levi := [ 1, 2, 3 ],
          locsys := [ [ 5, 2 ] ] ), rec(
          relgroup := .,
          Z := [ -E(4) ],
          levi := [ 1, 2, 3 ],
          locsys := [ [ 5, 4 ] ] ) ]|

The  'Display' and 'Format' functions for  unipotent classes accept all the
options  of 'FormatTable',  'CharNames'. Giving  the option 'mizuno' (resp.
'shoji')  uses  the  names  given  by  Mizuno  (resp.  Shoji) for unipotent
classes.  Moreover,  there  is  also  an  option  'fourier' which gives the
correspondence  tensored  with  the  sign  character  of each relative Weyl
group, which is the correspondence obtained via a Fourier-Deligne transform
(here  we assume that  $p$ is very  good, so that  there is a nondegenerate
invariant  bilinear  form  on  the  Lie  algebra, and also one can identify
nilpotent orbits with unipotent classes).

Here  is how  to display  only the  ordinary Springer correspondence of the
unipotent classes of 'E6' using the notations of Mizuno for the classes and
those of Frame for the characters of the Weyl group and of Spaltenstein for
the  characters of 'G2' (this is convenient  for checking our data with the
original paper of Spaltenstein)\:

|    gap> uc:=UnipotentClasses(CoxeterGroup("E",6));;
    gap> Display(uc,rec(columns:=[1..5],mizuno:=true,frame:=true,
    > spaltenstein:=true));
    1<A1<2A1<3A1<A2<A2+A1<A2+2A1<2A2+A1<A3+A1<D4(a1)<D4<D5(a1)<A5+A1<D5<E6\
    (a1)<E6
    A2+A1<2A2<2A2+A1
    A2+2A1<A3<A3+A1
    D4(a1)<A4<A4+A1<A5<A5+A1
    A4+A1<D5(a1)
         u |'\|'|   D-R dBu    B-C            C(u)                 E6()
    _______________________________________________________________
    E6     |'\|'|222222   0 222222             q^6                   1p
    E6(a1) |'\|'|222022   1 222022             q^8                   6p
    D5     |'\|'|220202   2 22222.       q^9.(q-1)                  20p
    A5+A1  |'\|'|200202   3 200202         q^12.Z2         11:15p 2:30p
    A5     |'\|'|211012   4 2.2222         q^11.A1                  15q
    D5(a1) |'\|'|121011   4 22202.      q^13.(q-1)                  64p
    A4+A1  |'\|'|111011   5 2222.2      q^15.(q-1)                  60p
    D4     |'\|'|020200   6 .2222.         q^10.A2                  24p
    A4     |'\|'|220002   6 2222..   q^14.A1.(q-1)                  81p
    D4(a1) |'\|'|000200   7 .2202. q^18.(q-1)^2.S3 111:20s 3:80s 21:90s
    A3+A1  |'\|'|011010   8 22.22.   q^18.A1.(q-1)                  60s
    2A2+A1 |'\|'|100101   9 222.22         q^21.A1                  10s
    A3     |'\|'|120001  10 2.22..   q^15.B2.(q-1)                 81p'
    A2+2A1 |'\|'|001010  11 222.2.   q^24.A1.(q-1)                 60p'
    2A2    |'\|'|200002  12 2.2.22         q^16.G2                 24p'
    A2+A1  |'\|'|110001  13 222...   q^23.A2.(q-1)                 64p'
    A2     |'\|'|020000  15 2.2...    q^20.(A2xA2)       11:15p' 2:30p'
    3A1    |'\|'|000100  16 22..2.      q^27.A2xA1                 15q'
    2A1    |'\|'|100001  20 22....   q^24.B3.(q-1)                 20p'
    A1     |'\|'|010000  25 2.....         q^21.A5                  6p'
    1      |'\|'|000000  36 ......              E6                  1p'|

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Section{ICCTable}
\index{ICCTable}

'ICCTable(<uc>[,<seriesNo>[,<q>]])'

This  function  gives  the  table  of  decompositions  of  the  functions $
X_{u,\varphi}$   in   terms   of   the   functions   $Y_{u,\varphi}$.  Here
$(u,\varphi)$  runs over the pairs where $u$  is a unipotent element of the
reductive  group  $\bG$  and  $\varphi$  is  a  character  of  the group of
components  $A(u)$; such a pair  describes a $\bG$-equivariant local system
on the class $C$ of $u$. The function $Y_{u,\varphi}$ is the characteristic
function  of this  local system  and $X_{u,\varphi}$  is the characteristic
function  of the  corresponding intersection  cohomology complex. The local
systems  can  also  be  indexed  by  characters  of the relative Weyl group
occurring  in  the  Springer  correspondence,  and since the coefficient of
$X_\chi$  on $Y_\psi$ is $0$ if $\chi$  and $\psi$ do not correspond to the
same  relative Weyl group (are not in  the same Springer series), the table
given  is for a given Springer series,  the series whose number is given by
the  argument 'seriesNo' (if omitted this defaults to 'seriesNo=1' which is
the principal series). The decomposition multiplicities are graded, and are
given as polynomials in one variable (specified by the argument <q>; if not
given 'Indeterminate(Rationals)' is assumed).

|    gap> W:=CoxeterGroup("A",3);;
    gap> uc:=UnipotentClasses(W);;
    gap> Display(ICCTable(uc));
    Coefficients of X_phi on Y_psi for A3

          |'\|'|4 31 22 211 1111
    ________________________
    X4    |'\|'|1  1  1   1    1
    X31   |'\|'|0  1  1  P2   P3
    X22   |'\|'|0  0  1   1   P4
    X211  |'\|'|0  0  0   1   P3
    X1111 |'\|'|0  0  0   0    1|

In  the  above  the  multiplicities  are  given  as  products of cyclotomic
polynomials  to display  them more  compactly. However  the 'Format' or the
'Display'   of  such  a  table  can   be  controlled  more  precisely.

For  instance,  one  can  ask  to  not  display  the entries as products of
cyclotomic polynomials\:

|    gap> Display(ICCTable(uc),rec(CycPol:=false));
    Coefficients of X_phi on Y_psi for A3

          |'\|'|4 31 22 211    1111
    ___________________________
    X4    |'\|'|1  1  1   1       1
    X31   |'\|'|0  1  1 q+1 q^2+q+1
    X22   |'\|'|0  0  1   1   q^2+1
    X211  |'\|'|0  0  0   1 q^2+q+1
    X1111 |'\|'|0  0  0   0       1|

Since  'Display'  and  'Format'  use  the  function  "FormatTable", all the
options  of this function are  also available. We can  use this to restrict
the entries displayed to a given subset of the rows and columns\:

|    gap> W:=CoxeterGroup("F",4);;
    gap> uc:=UnipotentClasses(W);;
    gap> show:=[13,24,22,18,14,9,11,19];;
    gap> Display(ICCTable(uc),rec(rows:=show,columns:=show));
    Coefficients of X_phi on Y_psi for F4

                |'\|'|A1+~A1 A2 ~A2 A2+~A1 ~A2+A1 B2(11) B2 C3(a1)(11)
    ______________________________________________________________
    Xphi{9,10}  |'\|'|     1  0   0      0      0      0  0          0
    Xphi{8,9}'' |'\|'|     1  1   0      0      0      0  0          0
    Xphi{8,9}'  |'\|'|     1  0   1      0      0      0  0          0
    Xphi{4,7}'' |'\|'|     1  1   0      1      0      0  0          0
    Xphi{6,6}'  |'\|'|    P4  1   1      1      1      0  0          0
    Xphi{4,8}   |'\|'|   q^2  0   0      0      0      1  0          0
    Xphi{9,6}'' |'\|'|    P4 P4   0      1      0      0  1          0
    Xphi{4,7}'  |'\|'|   q^2  0  P4      0      1      0  0          1|

The function 'ICCTable' returns a record with various pieces of information
which can help further computations.

.scalar:\\ this contains the table of multiplicities $P_{\psi,\chi}$ of the
$X_\psi$  on the  $Y_\chi$. One  should pay  attention that by default, the
table  is not displayed in the same order as the stored |.scalar|, which is
in  order  of  the  characters  in  the  relative  Weyl group; the table is
transposed,  then lines  and rows  are sorted  by |dimBu,class  no,index of
character in A(u)| while displayed.

.group:\\ The group <W>.

.relgroup:\\ The relative Weyl group for the Springer series.

.series:\\ The index of the Springer series given for <W>.

.dimBu:\\  The list of  $\dim\cB_u$ for each  local system $(u,\varphi)$ in
the series.

.L:\\  The  matrix  of  (unnormalized)  scalar  products  of  the functions
$Y_\psi$   with   themselves,   that   is   the   $(\phi,\psi)$   entry  is
$\sum_{g\in\bG(\F_q)}  Y_\phi(g)  \overline{Y_\psi(g)}$.  This  is  thus  a
symmetric,  block-diagonal matrix  where the  diagonal blocks correspond to
geometric  unipotent  conjugacy  classes.  This  matrix  is  obtained  as a
by-product of Lusztig\'s algorithm to compute $P_{\psi,\chi}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Section{SpecialPieces}
\index{SpecialPieces}

'SpecialPieces(<uc>)'

The  special  pieces  forme  a  partition  of  the  unipotent  variety of a
reductive  group  $\bG$  which  was  defined  the first time in \cite[chap.
III]{spalt82}  as  the  fibers  of  $d^2$,  where $d$ is a \"duality map\".
Another  definition is as  the set of  classes in the  Zariski closure of a
special  class and not in the Zariski closure of any smaller special class,
where a special class in the support of the image of a special character by
the Springer correspondence.

Each  piece is a union of unipotent  conjugacy classes so is represented in
\CHEVIE\  as a list  of class numbers.  Thus the list  of special pieces is
returned  as  a  list  of  lists  of  class  numbers. The list is sorted by
increasing  piece dimension, while each piece is sorted by decreasing class
dimension, so the special class is listed first.

|    gap> W:=CoxeterGroup("G",2);
    CoxeterGroup("G",2)
    gap> SpecialPieces(UnipotentClasses(W));
    [ [ 1 ], [ 4, 3, 2 ], [ 5 ] ]
    gap> SpecialPieces(UnipotentClasses(W,3));
    [ [ 1 ], [ 4, 3, 2, 6 ], [ 5 ] ]|

The   example  above  shows  that  the  special  pieces  are  different  in
characteristic 3.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Section{InducedLinearForm}
\index{InducedLinearForm}

'InducedLinearForm(<W>, <K>, h)'

This routine can be used to find the Richardson-Dynkin diagram of the class
in  the algebraic group $\bG$  which contains a given  unipotent class of a
reductive subgroup of maximum rank $\bS$ of $\bG$.

It  takes a linear  form on the  roots of <K>,  defined by its value on the
simple  roots (these values  can define a  Dynkin-Richardson diagram); then
extends  this linear form to the roots of $\bG$ by $0$ on the orthogonal of
the  roots of <K>; and finally conjugates  the resulting form by an element
of the Weyl group so that it takes positive values on the simple roots.

|    gap> W:=CoxeterGroup("F",4);;
    gap> H:=ReflectionSubgroup(W,[1,3]);;
    gap> InducedLinearForm(W,H,[2,2]);
    [ 0, 1, 0, 0 ]
    gap> uc:=UnipotentClasses(W);;
    gap> Display(uc.classes[4]);
    A1+~A1: D-R0100 C=q^18.A1xA1|

The  example above shows that the class containing the regular class of the
Levi subgroup of type $A_1\times \tilde A_1$ is the class |A1+~A1|.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\Section{GreenTable}
%
%'GreenTable(<uc>,q)'
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\Section{UnipotentValues}
%
%'UnipotentValues(<W>,<w>)'
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
